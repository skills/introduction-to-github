<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø¹Ø§Ù„Ù… Ù„ÙˆÙ„Ùˆ Ù…Ù„ÙƒØªÙŠ</title>
  <style>
    body{font-family:Arial,sans-serif;background:#f9f3ff;color:#444;margin:0;padding:0;text-align:center;}
    .container{max-width:600px;margin:20px auto;background:#fff;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.1);padding:20px;}
    .hidden{display:none;}
    .btn{background:#d17fcc;color:#fff;border:none;padding:10px 15px;margin:5px;border-radius:8px;cursor:pointer;}
    .btn:hover{background:#b04fa1;}
    .section{margin-top:20px;text-align:right;}
    ul{list-style:none;padding:0;}
    li{margin:8px 0;display:flex;justify-content:space-between;align-items:center;}
    .message-box{background:#fff0f5;padding:15px;border-radius:10px;margin-top:10px;text-align:right;}
    .progress{background:#eee;border-radius:5px;overflow:hidden;margin:5px 0;}
    .progress-bar{height:10px;background:#d17fcc;width:0%;}
    label{display:block;margin-top:10px;}
    input[type=range]{width:100%;}
  </style>
</head>
<body>
  <div id="role-selection" class="container">
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ù„Ù… Ù„ÙˆÙ„Ùˆ Ù…Ù„ÙƒØªÙŠ</h1>
    <button class="btn" onclick="selectRole('queen')">Ø£Ù†Ø§ Ø§Ù„Ù…Ù„ÙƒØ© ğŸ‘‘</button>
    <button class="btn" onclick="selectRole('serse7')">Ø£Ù†Ø§ Ø§Ù„Ø³Ø±Ø³ÙˆØ­ ğŸ‘</button>
  </div>

  <!-- Queen Interface -->
  <div id="queen-interface" class="container hidden">
    <h2>ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù„ÙƒØ© ğŸ‘‘</h2>

    <!-- Tasks -->
    <div class="section">
      <h3>Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…</h3>
      <ul id="tasks-list"></ul>
      <input id="task-input" type="text" placeholder="Ø£Ø¶Ù Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©â€¦" />
      <input id="task-duration" type="number" placeholder="Ù…Ø¯Ø© (Ø¯Ù‚Ø§Ø¦Ù‚)" style="width:120px;margin-right:5px;"/>
      <button class="btn" onclick="addTask()">Ø£Ø¶Ù</button>
      <div id="timer" style="margin-top:10px;"></div>
    </div>

    <!-- Gift Balance -->
    <div class="section">
      <h3>Ø±ØµÙŠØ¯ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§: <span id="gift-balance">0</span> Ø¯.Ø¹</h3>
      <div id="gifts-progress"></div>
      <button class="btn" onclick="requestGift()">Ø£Ø·Ø§Ù„Ø¨ Ù‡Ø¯ÙŠØ©</button>
    </div>

    <!-- Satisfaction -->
    <div class="section">
      <h3>Ø±Ø¶Ø§ Ø§Ù„Ù…Ù„ÙƒØ© Ø§Ù„ÙŠÙˆÙ…</h3>
      <label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <span id="satisfaction-value">5</span></label>
      <input id="satisfaction-range" type="range" min="1" max="10" value="5" oninput="$('#satisfaction-value').textContent=this.value"/>
      <textarea id="satisfaction-reason" placeholder="Ø§ÙƒØªØ¨ÙŠ Ø³Ø¨Ø¨ ØªÙ‚ÙŠÙŠÙ…Ùƒ..." rows="2" style="width:100%;"></textarea>
      <button class="btn" onclick="saveSatisfaction()">Ø§Ø­ÙØ¸ Ø§Ù„Ø±Ø¶Ø§</button>
    </div>

    <!-- Long Messages -->
    <div class="section">
      <h3>Ø±Ø³Ø§Ø¦Ù„ ØºØ²Ù„ Ø·ÙˆÙŠÙ„Ø©</h3>
      <button class="btn" onclick="showLongMessage()">Ø§ÙØªØ­ Ø±Ø³Ø§Ù„Ø© Ø­Ø¨</button>
      <div id="long-message" class="message-box hidden"></div>
    </div>
  </div>

  <!-- Serse7 Interface -->
  <div id="serse7-interface" class="container hidden">
    <h2>ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø³Ø±Ø³ÙˆØ­ ğŸ‘</h2>

    <!-- Report Tasks -->
    <div class="section">
      <h3>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©</h3>
      <ul id="report-tasks"></ul>
    </div>

    <!-- Gift Requests -->
    <div class="section">
      <h3>Ø·Ù„Ø¨Ø§Øª Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„Ù…Ù„ÙƒØ©</h3>
      <ul id="gift-requests"></ul>
    </div>

    <!-- Satisfaction Display -->
    <div class="section">
      <h3>Ø±Ø¶Ø§ Ø§Ù„Ù…Ù„ÙƒØ© Ø§Ù„ÙŠÙˆÙ…</h3>
      <p>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: <span id="disp-sat-value">-</span> / 10</p>
      <p>Ø§Ù„Ø³Ø¨Ø¨: <span id="disp-sat-reason">-</span></p>
    </div>
  </div>

  <script>
    // Helpers
    const $ = id=>document.getElementById(id);

    // Role selection
    function selectRole(r){
      $('role-selection').classList.add('hidden');
      if(r==='queen') $('queen-interface').classList.remove('hidden');
      else $('serse7-interface').classList.remove('hidden');
      renderAll();
    }

    // Data
    let data = JSON.parse(localStorage.getItem('luluData')||'{}');
    data.tasks = data.tasks||[];
    data.completed = data.completed||[];
    data.giftBalance = data.giftBalance||0;
    data.giftRequests = data.giftRequests||[];
    data.usedLong = data.usedLong||[];
    data.satisfaction = data.satisfaction||{value:5,reason:''};

    function save(){ localStorage.setItem('luluData', JSON.stringify(data)); }

    // Tasks
    function renderTasks(){
      $('tasks-list').innerHTML='';
      data.tasks.forEach((t,i)=>{
        let li=document.createElement('li');
        li.textContent = t.text + ' ('+t.duration+'Ø¯)';
        let start=document.createElement('button');
        start.textContent='â–¶'; start.onclick=()=>startTimer(i);
        let done=document.createElement('button');
        done.textContent='âœ”'; done.onclick=()=>completeTask(i);
        li.append(start, done);
        $('tasks-list').appendChild(li);
      });
    }
    function addTask(){
      let txt=$('task-input').value.trim();
      let dur=parseInt($('task-duration').value)||0;
      if(!txt) return;
      data.tasks.push({text:txt,duration:dur*60});
      $('task-input').value=''; $('task-duration').value='';
      save(); renderTasks(); renderReport();
    }
    let timerInterval;
    function startTimer(i){
      clearInterval(timerInterval);
      updateTimer();
      function updateTimer(){
        let t = data.tasks[i].duration--;
        if(t<0){ clearInterval(timerInterval); $('timer').textContent='Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª'; return; }
        $('timer').textContent='Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: '+Math.floor(t/60)+' : '+('0'+t%60).slice(-2);
      }
      timerInterval = setInterval(updateTimer,1000);
    }
    function completeTask(i){
      data.completed.push(data.tasks[i]);
      data.tasks.splice(i,1);
      data.giftBalance++;
      save(); renderAll();
      alert('Ø¨Ø±Ø§ÙÙˆ! Ø¯ÙŠÙ†Ø§Ø± +1 Ø£Ø¶ÙŠÙ Ù„Ø­ØµØ§Ù„ØªÙƒ');
    }

    // Report for serse7
    function renderReport(){
      $('report-tasks').innerHTML = data.completed.map(t=>`<li>${t.text}</li>`).join('');
    }

    // Gifts
    function renderGifts(){
      $('gift-balance').textContent = data.giftBalance;
      let html='';
      [['Ø£ÙƒÙ„',5],['ÙƒØ§Ø´',10],['Ø´ÙŠ Ø§Ù†',20]].forEach(([name,thr])=>{
        let p=Math.min(100,(data.giftBalance/thr)*100);
        html+=`<div>${name}: <div class="progress"><div class="progress-bar" style="width:${p}%"></div></div></div>`;
      });
      $('gifts-progress').innerHTML=html;
    }
    function requestGift(){
      let req=prompt('Ø§ÙƒØªØ¨ Ø·Ù„Ø¨ Ø§Ù„Ù‡Ø¯ÙŠØ© Ù…Ø¹ Ø±Ø³Ø§Ù„Ø©:');
      if(req){
        data.giftRequests.push(req);
        save(); renderGifts(); renderRequests();
      }
    }
    function renderRequests(){
      $('gift-requests').innerHTML = data.giftRequests.map(r=>`<li>${r}</li>`).join('');
    }

    // Long messages
    const longMsgs = [
      "Ø£Ù†ØªÙ Ø§Ù„Ø£Ø¬Ù…Ù„ ÙÙŠ Ø­ÙŠØ§ØªÙŠ ÙˆØ£Ø¹Ø² Ù…Ø§ Ù„Ø¯ÙŠ...",
      "ÙƒÙ„ ÙŠÙˆÙ… ÙŠØ²Ø¯Ø§Ø¯ Ø´ÙˆÙ‚ÙŠ Ø¥Ù„ÙŠÙƒÙ Ø¨Ù„Ø§ Ø­Ø¯ÙˆØ¯...",
      "ÙŠØ§ Ø¨Ø·Ù„Ø© Ù‚Ù„Ø¨ÙŠØŒ ØªØ¨Ù‚ÙŠÙ† Ø³ÙŠØ¯Ø© Ù‚Ù„Ø¨ÙŠ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¨Ø¯...",
      "Ø¨ÙˆØ¬ÙˆØ¯ÙƒÙ ÙŠØ²Ù‡Ø± Ø¹Ø§Ù„Ù…ÙŠ ÙˆØªØ·ÙŠØ¨ Ø£ÙŠØ§Ù…ÙŠ...",
      "Ø£Ø­Ø¨ÙƒÙ ÙÙˆÙ‚ Ù…Ø§ ØªØµÙÙŠÙ† ÙŠØ§ Ù†ÙˆØ± Ø§Ù„Ø¹ÙŠÙ†...",
      "ØµÙˆØ±ØªÙƒ ÙÙŠ Ø®Ø§Ø·Ø±ÙŠ Ø£Ø¬Ù…Ù„ Ù„ÙˆØ­Ø© Ø±Ø³Ù…Øª...",
      "ØµÙˆØªÙƒÙ Ù„Ø­Ù†ÙŒ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ù‡Ø¬Ø© Ø¥Ù„Ù‰ ÙˆØ¬Ø¯Ø§Ù†ÙŠ...",
      "ÙÙŠ Ø­Ø¶ÙˆØ±ÙƒÙ Ø£Ø¬Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø³Ø¹Ø§Ø¯Ø© Ø¨Ù„Ø§ Ø§Ù†ØªÙ‡Ø§Ø¡...",
      "ÙƒÙ„ ÙƒÙ„Ù…Ø© Ù…Ù†ÙƒÙ Ø¨Ù„Ø³Ù… ÙŠØ¯Ø§ÙˆÙŠ Ø¬Ø±ÙˆØ­ÙŠ...",
      "Ø£Ù†ØªÙ Ù‚ØµÙŠØ¯ØªÙŠ Ø§Ù„Ø£Ø¨Ø¯ÙŠØ© ÙˆÙ†ÙˆØ±ÙŠ ÙÙŠ Ø§Ù„Ù„ÙŠØ§Ù„ÙŠ..."
    ];
    function showLongMessage(){
      let idx=longMsgs.findIndex(m=>!data.usedLong.includes(m));
      if(idx<0) return alert('Ù„Ø§ Ø±Ø³Ø§Ø¦Ù„ Ù…ØªØ¨Ù‚ÙŠØ© Ø§Ù„ÙŠÙˆÙ…');
      let msg=longMsgs[idx];
      data.usedLong.push(msg);
      $('long-message').textContent=msg;
      $('long-message').classList.remove('hidden');
      save();
    }

    // Satisfaction
    function renderSatisfaction(){
      $('satisfaction-range').value = data.satisfaction.value;
      $('satisfaction-value').textContent = data.satisfaction.value;
      $('satisfaction-reason').value = data.satisfaction.reason;
      $('disp-sat-value').textContent = data.satisfaction.value;
      $('disp-sat-reason').textContent = data.satisfaction.reason||'-';
    }
    function saveSatisfaction(){
      data.satisfaction.value = +$('satisfaction-range').value;
      data.satisfaction.reason = $('satisfaction-reason').value.trim();
      save(); renderSatisfaction();
      alert('ØªÙ… Ø­ÙØ¸ Ø±Ø¶Ø§ Ø§Ù„Ù…Ù„ÙƒØ©!');
    }

    // Render all
    function renderAll(){
      renderTasks(); renderReport(); renderGifts(); renderRequests(); renderSatisfaction();
    }

    window.onload = renderAll;
  </script>
</body>
</html>
